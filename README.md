# AVE Script

Расширение для браузера, позволяющее блокировать нежелательных продавцов и объявления на Avito.

## Возможности

### Основные функции

- Блокировка продавцов по ID
- Блокировка отдельных объявлений
- Скрытые объявления отображаются в отдельном контейнере
- Автоматическая подгрузка страниц (десктоп, опционально)
- Поддержка мобильной версии (m.avito.ru)

### Синхронизация

- **Автоматическая кроссбраузерная синхронизация** - изменения автоматически загружаются в облако и скачиваются на других устройствах
- **Bidirectional sync** - умное слияние при конфликтах с приоритетом локальных изменений
- **Подписки на чужие списки** - возможность подписаться на общие списки (read-only)

## Установка

### Браузерное расширение

1. Скачайте расширение для вашего браузера из [релизов](https://github.com/xob0t/ave-script/releases)
2. **Chrome:** Откройте `chrome://extensions/`, включите "Режим разработчика", перетащите .zip файл
3. **Firefox:** Откройте `about:addons`, нажмите шестеренку → "Установить дополнение из файла"

### Userscript (Tampermonkey/Violentmonkey)

1. Установите [Tampermonkey](https://www.tampermonkey.net/) или [Violentmonkey](https://violentmonkey.github.io/)
2. [Установите скрипт](https://github.com/xob0t/ave-script/releases/latest/download/ave_script.user.js)

### Сборка из исходников

```bash
bun install

# Браузерное расширение
bun run build           # Chrome (MV3)
bun run build:firefox   # Firefox (MV2)

# Userscript
bun run build:userscript

# Все варианты
bun run build:all
```

Результаты сборки:
- `.output/chrome-mv3/` - расширение для Chrome
- `.output/firefox-mv2/` - расширение для Firefox
- `.output/userscript/ave_script.user.js` - userscript

## Использование

- **Расширение:** Нажмите на иконку расширения в панели инструментов браузера
- **Userscript:** Откройте меню Tampermonkey/Violentmonkey → AVE Script

### Настройка синхронизации между устройствами

1. **На первом устройстве:**
   - Откройте меню расширения
   - Выберите "Включить синхронизацию"
   - Введите название списка
   - Выберите "Получить данные для синхронизации" - учетные данные будут скопированы в буфер обмена

2. **На втором устройстве:**
   - Откройте меню расширения
   - Выберите "Подключить синхронизацию"
   - Вставьте JSON из буфера обмена
   - Готово! Изменения теперь синхронизируются автоматически

### Автоматическая синхронизация

- **При изменениях:** Блокировка/разблокировка автоматически загружается в облако через 2 секунды
- **При загрузке страницы:** Автоматически скачиваются изменения с других устройств
- **Периодическая синхронизация:** Каждые 5 минут в фоновом режиме

### Подписка на общие списки (read-only)

Подписки позволяют использовать чужие списки блокировок без возможности их редактирования.

1. Получите List ID от владельца списка
2. Откройте меню расширения → "Управление подписками"
3. Добавьте подписку
4. Все блокировки из подписок объединяются с вашим личным списком

**Важно:**

- Подписки работают только на чтение - вы не можете разблокировать объявления из чужих списков
- Чтобы разблокировать что-то из подписки, отключите её в "Управление подписками"
- Ваш личный список и синхронизация работают независимо от подписок

## Разработка

```bash
bun install
bun run dev          # Chrome с hot reload
bun run dev:firefox  # Firefox с hot reload
```

## Технологии

- [WXT](https://wxt.dev/) - фреймворк для кросс-браузерных расширений
- [Bun](https://bun.sh/) - пакетный менеджер и рантайм
- TypeScript
- IndexedDB для локального хранения
- Supabase для облачной синхронизации
